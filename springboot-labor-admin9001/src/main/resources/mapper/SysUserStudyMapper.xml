<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.xiaozhang.springboot.mapper.SysUserStudyMapper">

    <select id="selectVarietyCount" resultType="com.xiaozhang.springboot.domain.SysStudyData">
        select ifnull(sus.update_time,sus.create_time) as time,count(case when ssd.type=0 then 1 end) as textNum,count(case when ssd.type=1 then 1 end) as videoNum,count(case when ssd.type=2 then 1 end) as PDFNum
        from sys_study_data ssd
        join sys_user_study sus on ssd.id = sus.study_id
        where ssd.id
        in(select study_id
        from sys_user_study
        where ifnull(update_time,create_time) between #{start} and #{end} and user_id = #{userId})
        group by time
    </select>
</mapper>
